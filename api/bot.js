import { Telegraf } from 'telegraf';

const BOT_TOKEN = process.env.BOT_TOKEN;
const bot = new Telegraf(BOT_TOKEN);

// Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ð´Ð»Ñ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð¾Ð² Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ (Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ…)
const userTimers = new Map();

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start
bot.start(async (ctx) => {
    const userId = ctx.from.id;
    console.log('Received start command from:', userId);
    
    // ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ðµ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ ÐµÑÑ‚ÑŒ
    if (userTimers.has(userId)) {
        const timers = userTimers.get(userId);
        timers.forEach(timerId => clearTimeout(timerId));
        userTimers.delete(userId);
    }
    
    await ctx.reply('Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² ÑÐµÑ€Ð²Ð¸Ñ Â«HW AsÂ»! Ð”Ð»Ñ Ð½Ð°Ñ‡Ð°Ð»Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð²Ñ‹ Ð½Ðµ Ñ€Ð¾Ð±Ð¾Ñ‚.');
    
    const { Markup } = await import('telegraf');
    
    await ctx.reply(
        'ÐžÑ‚Ð²ÐµÑ‚ÑŒÑ‚Ðµ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾Ñ: ÐšÐ°Ðº Ð½Ð°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¼ÐµÑÑ‚Ð¾, Ð³Ð´Ðµ Ð³Ñ€ÑƒÐ¿Ð¿Ð° Ð¼ÑƒÐ¶Ñ‡Ð¸Ð½ Ð·Ð°Ð½Ð¸Ð¼Ð°ÐµÑ‚ÑÑ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¼ Ð¿Ð»Ð°Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð² Ð¾Ð±Ñ‚ÑÐ³Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ñ… ÐºÑƒÐ¿Ð°Ð»ÑŒÐ½Ð¸ÐºÐ°Ñ…?',
        Markup.inlineKeyboard([
            [Markup.button.callback('Ð‘Ð°ÑÑÐµÐ¹Ð½', 'answer_1')],
            [Markup.button.callback('Ð’Ð¾Ð´Ð½Ñ‹Ð¹ ÑÑ‚Ð°Ð´Ð¸Ð¾Ð½', 'answer_2')],
            [Markup.button.callback('Ð“ÐµÐ¹-ÐºÐ»ÑƒÐ± "ÐÐºÐ²Ð°Ð¼Ð°Ñ€Ð¸Ð½"', 'answer_3')]
        ])
    );
});

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹
bot.action('answer_1', async (ctx) => {
    await ctx.answerCbQuery();
    await ctx.editMessageText('ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ðµ Ñ€Ð°Ð·!');
});

bot.action('answer_2', async (ctx) => {
    await ctx.answerCbQuery();
    await ctx.editMessageText('ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ðµ Ñ€Ð°Ð·!');
});

bot.action('answer_3', async (ctx) => {
    const userId = ctx.from.id;
    await ctx.answerCbQuery();
    await ctx.editMessageText('ÐŸÐ¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÐµÐ¼! Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð² ÐºÐ»ÑƒÐ±Ðµ Â«ÐÐºÐ²Ð°Ð¼Ð°Ñ€Ð¸Ð½Â» ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°! Ð’Ð°ÑˆÐ° Ð°Ð½ÐºÐµÑ‚Ð° Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð¼. ÐžÐ¶Ð¸Ð´Ð°Ð¹Ñ‚Ðµ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐµÐ½Ð¸Ñ Ð½Ð° Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÑƒ. Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾ Ð·Ð° Ñ‡ÐµÑÑ‚Ð½Ð¾ÑÑ‚ÑŒ!');
    
    // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
    startMessageTimers(userId, ctx);
});

// Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð¾Ð² ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
function startMessageTimers(userId, ctx) {
    const timers = [];
    
    // Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð°Ð¼Ð¸ (Ð²Ñ€ÐµÐ¼Ñ Ð² Ð¼Ð¸Ð»Ð»Ð¸ÑÐµÐºÑƒÐ½Ð´Ð°Ñ…)
    const messages = [
        { time: 2 * 60 * 1000, text: `1. Ð’Ð¸Ñ‚Ð°Ð»Ð¸Ð¹, Ñ‚Ñ€ÐµÐ½ÐµÑ€ (45 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«ÐŸÑ€Ð¸Ð²ÐµÑ‚, Ð¼Ñ‹ÑˆÐºÐ°. Ð¯ Ñ‚Ð²Ð¾Ð¹ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ½ÐµÑ€. ÐœÐ¾Ð¸ Ñ‚Ñ€ÐµÐ½Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ð´Ð»ÑÑ‚ÑÑ Ð¿Ð¾ 3 Ñ‡Ð°ÑÐ°, Ð¸ Ñ Ð½Ðµ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÑŽ ÑÐ»Ð¾Ð²Ð° "Ð½Ðµ Ð¼Ð¾Ð³Ñƒ". Ð“Ð¾Ñ‚Ð¾Ð²ÑŒ ÑÐ²Ð¾Ð¸ Ð¼ÑÐ³ÐºÐ¸Ðµ Ð¼ÐµÑÑ‚Ð° Ðº ÑÐµÑ€ÑŒÐµÐ·Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ. ÐšÑƒÐ¿Ð°Ð»ÑŒÐ½Ð°Ñ ÑˆÐ°Ð¿Ð¾Ñ‡ÐºÐ° Ð½Ðµ Ð¿Ð¾Ð½Ð°Ð´Ð¾Ð±Ð¸Ñ‚ÑÑ.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 2` },
        { time: 4 * 60 * 1000, text: `2. Ð­Ð»ÑŒ ÐŸÐ¾Ð¼Ð¸Ð´Ð¾Ñ€Ð¾ (32 Ð³Ð¾Ð´Ð°, Ð‘Ð°Ñ€ÑÐµÐ»Ð¾Ð½Ð°)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Hola, Ð¾Ð³Ð½ÐµÐ³Ñ€Ð¸Ð²Ñ‹Ð¹! Ð¯ ÑÐ³Ð¾Ñ€Ð°ÑŽ Ð¾Ñ‚ ÑÑ‚Ñ€Ð°ÑÑ‚Ð¸, ÐºÐ°Ðº Ð¿Ð¾Ð¼Ð¸Ð´Ð¾Ñ€ Ð½Ð° ÑÐ¾Ð»Ð½Ñ†Ðµ. Ð’ Ð¼Ð¾ÐµÐ¹ ÑÑ‚ÑƒÐ´Ð¸Ð¸ ÐµÑÑ‚ÑŒ Ð´Ð¶Ð°ÐºÑƒÐ·Ð¸ Ð½Ð° Ð´Ð²Ð¾Ð¸Ñ… Ð¸ ÐºÐ¾Ð¶Ð°Ð½Ñ‹Ð¹ Ð´Ð¸Ð²Ð°Ð½ Ð´Ð»Ñ... Ð¾Ñ‚Ð´Ñ‹Ñ…Ð° Ð¿Ð¾ÑÐ»Ðµ Ð²Ð¾Ð´Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€. ÐŸÑ€Ð¸ÐµÐ·Ð¶Ð°Ð¹, Ð±ÑƒÐ´ÐµÐ¼ Ñ‚Ð°Ð½Ñ†ÐµÐ²Ð°Ñ‚ÑŒ Ñ‚Ð°Ð½Ð³Ð¾ Ð±ÐµÐ· Ñ‚Ñ€ÑƒÑÐ¾Ð².Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 4` },
        { time: 4 * 60 * 1000, text: `3. ÐšÐ¾ÑÑ‚Ñ-ÐŸÑ‡ÐµÐ»Ð° (19 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Ð–Ð¶Ñƒ-Ð¶Ð¶Ñƒ, ÑÐ»Ð°Ð´ÐºÐ¸Ð¹ Ð¼Ð¾Ð¹ Ð¼Ð°Ð»ÑŒÑ‡Ð¸Ðº! Ð¯ Ð¾Ð¿Ñ‹Ð»ÑÑŽ Ð²ÑÐµ Ñ†Ð²ÐµÑ‚Ñ‹ Ð² Ð½Ð°ÑˆÐµÐ¼ ÑÐ°Ð´Ñƒ. ÐœÐ¾Ð¹ ÑƒÐ»ÐµÐ¹ Ñ‚ÐµÐ¿Ð»Ñ‹Ð¹ Ð¸ Ð»Ð¸Ð¿ÐºÐ¸Ð¹ Ð¾Ñ‚ Ð¼ÐµÐ´Ð°. Ð¥Ð¾Ñ‡ÐµÑˆÑŒ Ð·Ð°Ð»ÐµÐ·Ñ‚ÑŒ Ð²Ð½ÑƒÑ‚Ñ€ÑŒ Ð¸ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ð¼Ð½Ðµ Ñ Ð¼ÐµÐ´Ð¾ÑÐ±Ð¾Ñ€Ð¾Ð¼? Ð‘ÑƒÐ´Ñƒ Ð¶Ð°Ð»Ð¸Ñ‚ÑŒ Ð½ÐµÐ¶Ð½Ð¾.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 4 (Ð² Ð¿Ð°Ñ€Ðµ Ñ Ð­Ð»ÑŒ ÐŸÐ¾Ð¼Ð¸Ð´Ð¾Ñ€Ð¾)` },
        { time: 7 * 60 * 1000, text: `4. ÐÐ½Ð´Ñ€ÐµÐ¹ Ð˜Ð³Ð¾Ñ€ÐµÐ²Ð¸Ñ‡ (Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€ Ð±Ð°ÑÑÐµÐ¹Ð½Ð°, 51 Ð³Ð¾Ð´)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«ÐœÐ°Ð»ÑŒÑ‡Ð¸Ðº, Ñ Ð½Ð°Ð±Ð»ÑŽÐ´Ð°ÑŽ Ð·Ð° Ñ‚Ð¾Ð±Ð¾Ð¹ Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð° Ð² ÐºÐ°Ð±Ð¸Ð½ÐµÑ‚Ðµ 305. Ð£ Ð¼ÐµÐ½Ñ ÐµÑÑ‚ÑŒ ÑÐ²ÑÐ·ÐºÐ° ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð¾Ñ‚ Ð²ÑÐµÑ… Ð¿Ð¾Ð´ÑÐ¾Ð±Ð¾Ðº. Ð¥Ð¾Ñ‡ÐµÑˆÑŒ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½ÑƒÑŽ ÑÐºÑÐºÑƒÑ€ÑÐ¸ÑŽ Ð² Ð¼Ð¾ÑŽ "Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÑƒÑŽ ÐºÐ¾Ð¼Ð½Ð°Ñ‚Ñƒ"? ÐŸÑ€Ð¸Ñ…Ð¾Ð´Ð¸ Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ. Ð‘ÐµÐ· Ð¿Ð»Ð°Ð²Ð¾Ðº.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 7` },
        { time: 12 * 60 * 1000, text: `5. Ð¡ÐµÑ€Ñ‘Ð¶Ð°-ÐŸÐ¾ÑÑ‚ (22 Ð³Ð¾Ð´Ð°)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Ð¢Ð²Ð¾Ðµ Ñ‚ÐµÐ»Ð¾ â€“ ÑÑ‚Ð¾ ÑÐ¾Ð½ÐµÑ‚, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ñ Ñ…Ð¾Ñ‡Ñƒ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð½Ð°Ð¸Ð·ÑƒÑÑ‚ÑŒ Ð³ÑƒÐ±Ð°Ð¼Ð¸... Ð’ Ñ€Ð°Ð·Ð´ÐµÐ²Ð°Ð»ÐºÐµ, Ð½Ð° Ð¼Ð¾ÐºÑ€Ð¾Ð¹ Ð»Ð°Ð²ÐºÐµ. Ð¯ Ð½Ð°Ð¿Ð¸ÑˆÑƒ Ð¾ Ñ‚ÐµÐ±Ðµ Ð¿Ð¾ÑÐ¼Ñƒ "ÐžÐ´Ð° Ð²Ð»Ð°Ð¶Ð½Ñ‹Ð¼ Ñ‚Ñ€ÑƒÑÐ°Ð¼". ÐžÑ‚Ð²ÐµÑ‚ÑŒ Ð¼Ð½Ðµ, Ð¼Ð¾Ð¹ Ð³Ð¾Ñ„Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐÐ¿Ð¾Ð»Ð»Ð¾Ð½.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 12` },
        { time: 15 * 60 * 1000, text: `11. Ð”Ð¸Ð¼Ð°Ñ Ð‘Ð°Ñ€Ñ‚ÐµÐ»ÑŒ (18 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«ÐžÐ»ÐµÐ³, Ñ‚Ñ‹ Ñ‡Ðµ Ñ‚ÑƒÑ‚ Ð·Ð°Ð±Ñ‹Ð», Ð±Ð»#Ñ‚ÑŒ? Ð­Ñ‚Ð¾ Ð¶Ðµ Ð³ÐµÐ¹-ÐºÐ»ÑƒÐ±! Ð¢Ñ‹ Ñ‡Ðµ, Ð¾Ñ…ÑƒÐµÐ» Ð²Ð¾Ð¾Ð±Ñ‰Ðµ? Ð”Ð¸Ð¼Ð° Ð‘Ð°Ñ€Ñ‚ÐµÐ»ÑŒ, Ñ ÑÐ¾ÑÐµÐ´Ð½ÐµÐ³Ð¾ Ð¿Ð¾Ð´ÑŠÐµÐ·Ð´Ð°. ÐœÐ°Ð¼ÐºÐ° Ñ‚Ð²Ð¾Ñ Ð² ÐºÑƒÑ€ÑÐµ, ÐºÑƒÐ´Ð° Ñ‚Ñ‹ Ð·Ð°Ð¿Ð¸ÑÐ°Ð»ÑÑ?Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 15 (ÑÑ‚Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¼Ð¾Ñ‰Ð½Ñ‹Ð¹ ÑƒÐ´Ð°Ñ€)` },
        { time: 20 * 60 * 1000, text: `6. ÐœÐ°ÐºÑÐ¸Ð¼ Ð£Ð¿Ð¾Ñ€Ð½Ñ‹Ð¹ (Ð¡Ñ‚Ñ€Ð¾Ð¸Ñ‚ÐµÐ»ÑŒ, 28 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Ð¡Ð»ÑƒÑˆÐ°Ð¹ ÑÑŽÐ´Ð°, ÐºÑ€Ð°ÑÐ°Ð²Ñ‡Ð¸Ðº. Ð£ Ð¼ÐµÐ½Ñ ÐµÑÑ‚ÑŒ Ð¿ÐµÑ€Ñ„Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð²Ð¸Ð±Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð½Ð° 15 Ñ€ÐµÐ¶Ð¸Ð¼Ð°Ñ…. ÐŸÑ€Ð¸Ñ…Ð¾Ð´Ð¸ Ð½Ð° Ð¼Ð¾Ð¹ Ð¾Ð±ÑŠÐµÐºÑ‚, Ð·Ð°Ð¹Ð¼ÐµÐ¼ÑÑ "Ð¼Ð¾ÐºÑ€Ñ‹Ð¼Ð¸" Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð¼Ð¸. Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÑŽ, Ñ†ÐµÐ¼ÐµÐ½Ñ‚ Ð² ÑˆÑ‚Ð°Ð½Ð°Ñ… Ð·Ð°ÑÑ‚Ñ‹Ð½ÐµÑ‚ Ð½Ðµ ÑÑ€Ð°Ð·Ñƒ.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 20` },
        { time: 25 * 60 * 1000, text: `7. Ð”Ð¼Ð¸Ñ‚Ñ€Ð¸Ð¹ Ð¨ÐµÐ²Ñ‡ÐµÐ½ÐºÐ¾ (Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ðº, 41 Ð³Ð¾Ð´)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹. Ð¯ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒÑŽ Ð´Ñ€ÐµÐ²Ð½ÐµÑ€Ð¸Ð¼ÑÐºÐ¸Ðµ Ñ‚Ñ€Ð°Ð´Ð¸Ñ†Ð¸Ð¸. Ð’ Ð±Ð°Ð½Ðµ, Ñ Ð²ÐµÐ½Ð¸ÐºÐ°Ð¼Ð¸ Ð¸ Ð¼Ð°ÑÐ»Ð°Ð¼Ð¸. Ð˜Ñ‰Ñƒ ÑÐµÐ½Ð°Ñ‚Ð¾Ñ€Ð° Ð´Ð»Ñ Ð¾Ð±ÑÑƒÐ¶Ð´ÐµÐ½Ð¸Ñ Ð·Ð°ÐºÐ¾Ð½Ð¾Ð² Ð¸ Ð²Ð·Ð°Ð¸Ð¼Ð½Ð¾Ð³Ð¾ Ñ€Ð°ÑÑ‚Ð¸Ñ€Ð°Ð½Ð¸Ñ. ÐÐ°ÑˆÐ° Ð´Ñ€ÑƒÐ¶Ð±Ð° Ð±ÑƒÐ´ÐµÑ‚ ÐºÑ€ÐµÐ¿Ñ‡Ðµ, Ñ‡ÐµÐ¼ ÑÑ‚ÐµÐ½Ñ‹ Ð¡Ð¿Ð°Ñ€Ñ‚Ñ‹.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 25` },
        { time: 30 * 60 * 1000, text: `8. Ð¡Ñ‚Ð°Ñ (Ð‘Ð°Ñ€Ð¼ÐµÐ½, 25 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Ð­Ð¹, Ð´ÐµÑ‚ÐºÐ°! Ð¯ ÑÐ¼ÐµÑˆÐ°ÑŽ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ ÐºÐ¾ÐºÑ‚ÐµÐ¹Ð»ÑŒ 'Ð“Ð¾Ð»ÑƒÐ±Ð°Ñ Ñ„Ð¸ÐµÑÑ‚Ð°': Ñ‚ÐµÐºÐ¸Ð»Ð°, ÑÐ¸Ð½Ð¸Ð¹ ÐºÑŽÑ€Ð°ÑÐ°Ð¾ Ð¸ Ð¼Ð¾Ð¹ Ð¾ÑÐ¾Ð±Ñ‹Ð¹ ÑÐ¾Ðº. Ð‘ÑƒÐ´ÐµÑ‚ Ð³Ð¾Ñ€ÑÑ‡Ð¾ Ð¸ Ð¿ÐµÐ½Ð¾Ð¾Ð¾. ÐžÑÑ‚Ð°Ð½ÐµÑˆÑŒÑÑ Ð½Ð¾Ñ‡ÑŒÑŽ Ð²Ñ‹Ñ‚Ð¸Ñ€Ð°Ñ‚ÑŒ Ð¼Ð¾Ð¸ ÑÑ‚Ð¾Ð»Ð¸ÐºÐ¸?Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 30` },
        { time: 35 * 60 * 1000, text: `12. Ð”Ð¼Ð¸Ñ‚Ñ€Ð¸Ð¹ ÐŸÐ¾Ñ‚Ð°Ð¿Ð¾Ð² (Ð¢ÐµÑ€Ð¼Ð¸Ð½Ð°Ñ‚Ð¾Ñ€)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«Ð¯ â€” Ð¢Ð•Ð ÐœÐ˜ÐÐÐ¢ÐžÐ . ÐœÐ¾Ñ Ð¼Ð¸ÑÑÐ¸Ñ â€” Ð¾Ð¿Ð»Ð¾Ð´Ð¾Ñ‚Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ. Ð¢Ñ‹ Ð±ÑƒÐ´ÐµÑˆÑŒ Ð¾Ñ‚Ñ†Ð¾Ð¼ Ð¼Ð¾ÐµÐ³Ð¾ ÐºÐ¸Ð±Ð¾Ñ€Ð³Ð°. Ð’Ð°ÑˆÐ° Ð¾Ð´ÐµÐ¶Ð´Ð° Ð±ÐµÑÐ¿Ð¾Ð»ÐµÐ·Ð½Ð°. ÐŸÑ€Ð¸Ð³Ð¾Ñ‚Ð¾Ð²ÑŒÑÑ Ðº Ð°ÑÑÐ¸Ð¼Ð¸Ð»ÑÑ†Ð¸Ð¸.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 35` },
        { time: 40 * 60 * 1000, text: `9. ÐÑ€Ñ‚Ñ‘Ð¼-Ð­ÐºÐ¾Ð»Ð¾Ð³ (30 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«ÐŸÑ€Ð¸Ð²ÐµÑ‚, Ñ Ð¸ÑÑÐ»ÐµÐ´ÑƒÑŽ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ ÑÑ€ÐµÐºÑ†Ð¸Ð¸... Ð¿Ñ€Ð¾ÑÑ‚Ð¸, Ð­Ð ÐžÐ—Ð˜Ð˜ Ð¿Ð¾Ñ‡Ð²! ÐÑƒÐ¶ÐµÐ½ Ð¿Ð¾Ð¼Ð¾Ñ‰Ð½Ð¸Ðº Ð´Ð»Ñ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾Ð³Ð¾ Ð±ÑƒÑ€ÐµÐ½Ð¸Ñ. Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ Ð½Ð¾Ñ‡ÑŒÑŽ, Ð² Ð¿Ð°Ð»Ð°Ñ‚ÐºÐµ, Ð¿Ð°Ñ‡ÐºÐ°ÐµÐ¼ÑÑ Ñ Ð³Ð¾Ð»Ð¾Ð²Ñ‹ Ð´Ð¾ Ð½Ð¾Ð³. ÐšÐ¾Ð½Ñ‡Ð°ÐµÐ¼ Ð¿Ð¾Ð»ÐµÐ²Ñ‹Ð¼ Ð·Ð°Ð²Ñ‚Ñ€Ð°ÐºÐ¾Ð¼.Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 40` },
        { time: 50 * 60 * 1000, text: `10. Ð®Ñ€Ð¸Ð¹ Ð“Ð°Ð³Ð°Ñ€Ð¸Ð½ (Ð‘Ñ‹Ð²ÑˆÐ¸Ð¹ Ð»ÐµÑ‚Ñ‡Ð¸Ðº, 55 Ð»ÐµÑ‚)\n\nÂ· Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ: Â«ÐšÐ¾Ð¼Ð°Ð½Ð´Ð¸Ñ€, Ñ Ð³Ð¾Ñ‚Ð¾Ð²Ð»ÑŽÑÑŒ Ðº Ð½Ð¾Ð²Ð¾Ð¼Ñƒ Ð¿Ð¾Ð»ÐµÑ‚Ñƒ. ÐÑƒÐ¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð² Ð¼Ð¾ÐµÐ¼ ÑˆÐ»Ð°Ð½Ð³Ðµ ÑÐºÐ°Ñ„Ð°Ð½Ð´Ñ€Ð°. ÐŸÐ¾Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ñ Ñ€ÑƒÑ‡Ð½Ð¾Ð¹ ÑÑ‚Ñ‹ÐºÐ¾Ð²ÐºÐ¾Ð¹? ÐŸÐµÑ€ÐµÐ³Ñ€ÑƒÐ·ÐºÐ¸ Ð±ÑƒÐ´ÑƒÑ‚ Ð½ÐµÑ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ. ÐŸÐ¾ÐµÑ…Ð°Ð»Ð¸!Â»\nÂ· Ð’Ñ€ÐµÐ¼Ñ: ÐœÐ¸Ð½ÑƒÑ‚Ð° 50` }
    ];

    // Ð¨ÐºÐ²Ð°Ð» ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð½Ð° 55 Ð¼Ð¸Ð½ÑƒÑ‚Ðµ
    const floodMessages = [
        `13. Ð Ð¾Ð¼Ð°-ÐœÐ°ÑÑÐ°Ð¶Ð¸ÑÑ‚: Â«Ð Ð°Ð±Ð¾Ñ‚Ð°ÑŽ Ñ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¸Ð¼Ð¸ Ñ‚ÐºÐ°Ð½ÑÐ¼Ð¸. Ð¡Ð½Ð¸Ð¼Ñƒ Ñ‚Ð²Ð¾Ð¸ Ð·Ð°Ð¶Ð¸Ð¼Ñ‹ Ð² Ñ€Ð°Ð¹Ð¾Ð½Ðµ Ð¿Ð°Ñ…Ð°. Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾ Ð´Ð»Ñ Ð½Ð¾Ð²Ð¸Ñ‡ÐºÐ¾Ð².Â»`,
        `14. ÐÐ½Ñ‚Ð¾Ð½-ÐšÐ¸Ð½Ð¾Ð»Ð¾Ð³: Â«Ð£ Ð¼ÐµÐ½Ñ Ð¾Ð²Ñ‡Ð°Ñ€ÐºÐ°, Ð¾Ñ‡ÐµÐ½ÑŒ Ð´Ð¾Ð±Ñ€Ð°Ñ. Ð›ÑŽÐ±Ð¸Ñ‚ Ð¸Ð³Ñ€Ð°Ñ‚ÑŒ Ñ Ð¿Ð°Ð»ÐºÐ°Ð¼Ð¸. ÐœÐ¾Ð¶ÐµÑˆÑŒ Ð¿Ð¾Ð³Ð»Ð°Ð´Ð¸Ñ‚ÑŒ. Ð˜ Ð¼ÐµÐ½Ñ Ð·Ð°Ð¾Ð´Ð½Ð¾.Â»`,
        `15. Ð’Ð»Ð°Ð´Ð¸ÑÐ»Ð°Ð²-ÐŸÐ¾Ð²Ð°Ñ€: Â«Ð“Ð¾Ñ‚Ð¾Ð²Ð»ÑŽ ÑÐ¾ÑÐ¸ÑÐºÐ¸ Ð² Ñ‚ÐµÑÑ‚Ðµ. Ð¥Ð¾Ñ‡ÐµÑˆÑŒ, Ð¿Ð¾ÐºÐ°Ð¶Ñƒ, ÐºÐ°Ðº Ñ Ð¸Ñ… Ð½Ð°Ñ‡Ð¸Ð½ÑÑŽ? Ð˜ÑÐ¿ÐµÐºÑƒ Ñ‚ÐµÐ±Ðµ Ð±ÑƒÐ»ÐºÑƒ.Â»`,
        `16. ÐÑ€Ñ‚ÑƒÑ€-Ð¢Ð°ÐºÑÐ¸ÑÑ‚: Â«ÐŸÐ¾Ð´Ð²ÐµÐ·Ñƒ Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾. Ð£ Ð¼ÐµÐ½Ñ Ð½Ð° Ð·Ð°Ð´Ð½ÐµÐ¼ ÑÐ¸Ð´ÐµÐ½ÑŒÐµ Ð¼ÑÐ³Ñ‡Ðµ, Ñ‡ÐµÐ¼ Ð² Ð¿Ð¾ÑÑ‚ÐµÐ»Ð¸. ÐŸÐ¾ÐºÐ°Ñ‚Ð°ÐµÐ¼ÑÑ Ñ Ð²ÐµÑ‚ÐµÑ€ÐºÐ¾Ð¼?Â»`,
        `17. ÐŸÐ°ÑˆÐ°-ÐœÑƒÐ·Ñ‹ÐºÐ°Ð½Ñ‚: Â«Ð˜Ð³Ñ€Ð°ÑŽ Ð½Ð° Ñ„Ð»ÐµÐ¹Ñ‚Ðµ. ÐÐ°ÑƒÑ‡Ð¸ÑˆÑŒÑÑ Ð±Ñ€Ð°Ñ‚ÑŒ Ð²Ñ‹ÑÐ¾ÐºÐ¸Ðµ Ð½Ð¾Ñ‚Ñ‹. Ð£ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÑŽ Ñ‡Ð°ÑÑ‚Ð½Ñ‹Ðµ ÐºÐ¾Ð½Ñ†ÐµÑ€Ñ‚Ñ‹ Ð² Ð´ÑƒÑˆÐµ.Â»`,
        `18. ÐœÐ¸Ñ…Ð°Ð¸Ð»-ÐžÑ…Ñ€Ð°Ð½Ð½Ð¸Ðº: Â«Ð”ÐµÐ¶ÑƒÑ€ÑŽ Ð½Ð¾Ñ‡ÑŒÑŽ. Ð’ Ð¼Ð¾ÐµÐ¹ Ð±ÑƒÐ´ÐºÐµ Ñ‚ÐµÑÐ½Ð¾, Ð½Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€Ð¸Ð»ÐµÑ‡ÑŒ. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ð¼ Ñ‚Ð²Ð¾ÑŽ Ð¿Ñ€Ð¾Ñ…Ð¾Ð´Ð½ÑƒÑŽ.Â»`,
        `19. Ð˜Ð³Ð¾Ñ€ÑŒ-Ð¡Ð°Ð´Ð¾Ð²Ð¾Ð´: Â«Ð¡Ð°Ð¶Ð°ÑŽ Ð¾Ð³ÑƒÑ€Ñ†Ñ‹. ÐÑƒÐ¶Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ñ Ð¾Ð¿Ñ‹Ð»ÐµÐ½Ð¸ÐµÐ¼. Ð’ Ñ‚ÐµÐ¿Ð»Ð¸Ñ†Ðµ Ð¶Ð°Ñ€ÐºÐ¾ Ð¸ Ð²Ð»Ð°Ð¶Ð½Ð¾, ÐºÐ°Ðº Ð² Ñ‚Ñ€Ð¾Ð¿Ð¸ÐºÐ°Ñ….Â»`
    ];

    // Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð½Ð° 60 Ð¼Ð¸Ð½ÑƒÑ‚Ðµ
    const finalMessage = `ðŸ’Ž Ð¡Ð¢ÐÐ¢Ð£Ð¡: Ð’ÐÐ¨ ÐŸÐ ÐžÐ¤Ð˜Ð›Ð¬ â€” Ð¡Ð•ÐÐ¡ÐÐ¦Ð˜Ð¯!\nÐ—Ð° Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ñ‡Ð°Ñ Ð²Ð°ÑˆÑƒ Ð°Ð½ÐºÐµÑ‚Ñƒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ»Ð¸ **998** Ñ€Ð°Ð·.\nÐ’Ñ‹ Ð²Ð¾Ð·Ð³Ð»Ð°Ð²Ð»ÑÐµÑ‚Ðµ Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³ "ÐÐ¾Ð²Ð¸Ñ‡Ð¾Ðº Ð¼ÐµÑÑÑ†Ð°".\nÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÐºÐ»ÑƒÐ±Ð° "ÐÐºÐ²Ð°Ð¼Ð°Ñ€Ð¸Ð½" Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ Ð²Ð°Ð¼ Ð²ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ. Ð’Ð°ÑˆÐ° Ð»Ð¸Ñ‡ÐºÐ° ÑÐºÐ¾Ñ€Ð¾ Ð²Ð·Ð¾Ñ€Ð²ÐµÑ‚ÑÑ.`;

    // Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð´Ð»Ñ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
    messages.forEach(msg => {
        const timer = setTimeout(async () => {
            try {
                await ctx.telegram.sendMessage(userId, msg.text);
                console.log(`Sent message to ${userId} at ${msg.time/60000} min`);
            } catch (error) {
                console.error('Error sending message:', error);
            }
        }, msg.time);
        timers.push(timer);
    });

    // Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð´Ð»Ñ ÑˆÐºÐ²Ð°Ð»Ð° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ (55 Ð¼Ð¸Ð½ÑƒÑ‚)
    const floodTimer = setTimeout(async () => {
        try {
            await ctx.telegram.sendMessage(userId, 'ðŸ’¥ Ð¨ÐšÐ’ÐÐ› Ð—ÐÐ¯Ð’ÐžÐš (ÐœÐ¸Ð½ÑƒÑ‚Ð° 55)\n\nÐ¡Ñ€Ð°Ð·Ñƒ 7 ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð¿Ð¾Ð´Ñ€ÑÐ´, Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÑ€Ñ‹Ð²Ð°:');
            for (const floodMsg of floodMessages) {
                await ctx.telegram.sendMessage(userId, floodMsg);
                await new Promise(resolve => setTimeout(resolve, 500)); // ÐŸÐ°ÑƒÐ·Ð° 0.5 ÑÐµÐº Ð¼ÐµÐ¶Ð´Ñƒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÐ¼Ð¸
            }
        } catch (error) {
            console.error('Error sending flood messages:', error);
        }
    }, 55 * 60 * 1000);
    timers.push(floodTimer);

    // Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð´Ð»Ñ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ (60 Ð¼Ð¸Ð½ÑƒÑ‚)
    const finalTimer = setTimeout(async () => {
        try {
            await ctx.telegram.sendMessage(userId, '---\nÐ¤Ð˜ÐÐÐ› (ÐœÐ¸Ð½ÑƒÑ‚Ð° 60)\n');
            await ctx.telegram.sendMessage(userId, finalMessage);
        } catch (error) {
            console.error('Error sending final message:', error);
        }
    }, 60 * 60 * 1000);
    timers.push(finalTimer);

    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
    userTimers.set(userId, timers);

    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ðµ
    ctx.telegram.sendMessage(userId, 
        `ÐšÐ°Ñ‚Ð°Ð»Ð¾Ð³ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² ÐºÐ»ÑƒÐ±Ð° Â«ÐÐºÐ²Ð°Ð¼Ð°Ñ€Ð¸Ð½Â» (ÐŸÑ€ÐµÐ¼Ð¸ÑƒÐ¼-Ð²ÐµÑ€ÑÐ¸Ñ)\n\n` +
        `Ð’Ð°ÑˆÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð±ÑƒÐ´ÑƒÑ‚ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÐ° ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÑŽ...`
    );
}

bot.on('text', async (ctx) => {
    await ctx.reply('ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð´Ð»Ñ Ð¾Ñ‚Ð²ÐµÑ‚Ð° Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾Ñ.');
});

// ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð´Ð»Ñ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð¾Ð² (Ð½Ð° Ð²ÑÑÐºÐ¸Ð¹ ÑÐ»ÑƒÑ‡Ð°Ð¹)
bot.command('stop', async (ctx) => {
    const userId = ctx.from.id;
    if (userTimers.has(userId)) {
        const timers = userTimers.get(userId);
        timers.forEach(timerId => clearTimeout(timerId));
        userTimers.delete(userId);
        await ctx.reply('Ð¢Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹. Ð”Ð»Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ /start');
    } else {
        await ctx.reply('ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð¾Ð² Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾.');
    }
});

// Ð”Ð»Ñ Vercel - Ð²ÐµÐ±Ñ…ÑƒÐº Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº
export default async function handler(req, res) {
    if (req.method === 'POST') {
        console.log('Received webhook update:', JSON.stringify(req.body));
        try {
            await bot.handleUpdate(req.body);
            res.status(200).json({ ok: true });
        } catch (error) {
            console.error('Error handling update:', error);
            res.status(500).json({ error: 'Internal Server Error' });
        }
    } else {
        res.status(200).json({ 
            message: 'Bot is running',
            usage: 'Send POST requests to this endpoint with Telegram updates'
        });
    }
}

// Ð•ÑÐ»Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾ - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ polling
if (process.env.VERCEL !== '1') {
    bot.launch().then(() => {
        console.log('Bot started in polling mode');
    });
    
    process.once('SIGINT', () => bot.stop('SIGINT'));
    process.once('SIGTERM', () => bot.stop('SIGTERM'));
}
